## 管道
为了最佳的可移植性，决不应预先假设系统支持全双工管道。
管道的创建
```
#incldue <unistd.h>
int pipe(int fd[2]);
```
经由参数fd返回两个文件描述符：fd[0]为读而打开，fd[1]为写而打开。

学习dup2（复制）的用法。

## 函数popen和pclose
作用：创建一个连接到另一个进程的管道，然后读取其输出或向其输入端发送数据。
实现的操作：创建一个管道，fork一个子进程，关闭未使用的管道端，执行一个shell运行命令，然后等待命令的终止。
i```
#include <stdio.h>
FILE *popen(const char *cmdstring, const char *type);
// 返回值：若成功，返回文件指针; 若出错，返回NULL
int pclose(FILE *fp);
// 返回值：若成功，返回cmdstring的终止状态; 若出错，返回-1
```
函数popen先执行fork，然后调用exec执行cmdstring，并且返回一个标准I/O文件指针。

type:
+ "r": 返回的文件是可读的
+ "w"：返回的文件是可写的

注：阅读popen和pclose的源码有助于理解，在源码中使用了dup2函数将输入或输出复制到pipe的读或写文件描述符

## 协同进程
当一个过滤程序既产生某个过滤程序的输入，又读取该过滤程序的输出时，它就变成了协同进程。
popen只提供连接到另一个进程的标准输入或标准输出的一个单向管道，而协同进程则有连接到另一个进程的两个单向管道：一个接到其标准输入，另一个则来自其标准输出。
数据从父进程的读文件描述符fd1[0],通过管道1写入协同进程的标准输入，经过协同进程进行处理，然后从协同进程的标准输出流入管道2,管道2连接的父进程的读文件描述符（fd2[0]）

